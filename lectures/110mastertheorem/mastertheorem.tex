\documentclass{beamer}
\usepackage{cancel}
\usepackage{fancyvrb}
\usepackage{hyperref}
\usepackage{graphicx}
\usepackage{tikz}
\usepackage{tikz-qtree}
\usepackage{multicol}
\newcommand{\sect}[1]{
\section{#1}
\begin{frame}[fragile]\frametitle{#1}
}

\newcommand{\bi}{\begin{itemize}}
\newcommand{\ii}{\item}
\newcommand{\ei}{\end{itemize}}

\usepackage[english]{babel}

\usepackage[latin1]{inputenc}

\title[Master Theorem]
{
Master Theorem
}

\author[Geoffrey Matthews]
{Geoffrey Matthews}

\newcommand{\eff}[2]{$f\left(\frac{#1}{#2}\right)$}


\begin{document}

\begin{frame}
  \titlepage
\end{frame}

\sect{Example 1: $T(n) = aT(n/b) + f(n)$ with $a=2, b=3$}

{\tiny
\Tree
    [
      .$f(3^h)$
      [.$f(3^{h-1})$
        [.$f(3^{h-2})$
          [.$\vdots$
            [.$f(3)$
              [.$T(1)$ ]
              [.$T(1)$ ]
            ]
          ]
          [.$\vdots$
            [.$f(3)$
              [.$T(1)$ ]
              [.$T(1)$ ]
            ]
          ]
        ]
        [.$f(3^{h-2})$
          [.$\vdots$
            [.$f(3)$
              [.$T(1)$ ]
              [.$T(1)$ ]
            ]
          ]
          [.$\vdots$
          ]
        ]
      ]
      [.$f(3^{h-1})$
        [.$f(3^{h-2})$
          [.$\vdots$
            [.$f(3)$
              [.$T(1)$ ]
              [.$T(1)$ ]
            ]
          ]
          [.$\vdots$
          ]
        ]
        [.$f(3^{h-2})$
          [.$\vdots$
            [.$f(3)$
              [.$T(1)$ ]
              [.$T(1)$ ]
            ]
          ]
          [.$\vdots$
            [.$f(3)$
              [.$T(1)$ ]
              [.$T(1)$ ]
            ]
          ]
        ]
      ]
    ]
}    

\vfill

$h = \log_3 n
\hfill
2^{\log_3 n} = n^{\log_3 2} \approx n^{0.6}\mbox{ leaves}
\hfill
\sum_{i=0}^{\log_b n} a^if(n/b^i)
$


\end{frame}

\sect{Example 2: $T(n) = aT(n/b) + f(n)$ with $a=3, b=2$}

{\tiny
\Tree
    [
      .$f(2^h)$
      [.$f(2^{h-1})$
        [.$f(2^{h-2})$
          [.$\vdots$
            [.$f(2)$
              [.$T(1)$ ]
              [.$T(1)$ ]
              [.$T(1)$ ]
            ]
          ]
          [.$\vdots$
          ]
          [.$\vdots$
          ]
        ]
        [.$\vdots$
        ]
        [.$\vdots$
        ]
      ]
      [.$f(2^{h-1})$
        [.$f(2^{h-2})$
          [.$\vdots$
            [.$f(2)$
              [.$T(1)$ ]
              [.$T(1)$ ]
              [.$T(1)$ ]
            ]
          ]
          [.$\vdots$
          ]
          [.$\vdots$
          ]
        ]
        [.$\vdots$
        ]
        [.$\vdots$
        ]
      ]
      [.$f(2^{h-1})$
        [.$f(2^{h-2})$
          [.$\vdots$
            [.$f(2)$
              [.$T(1)$ ]
              [.$T(1)$ ]
              [.$T(1)$ ]
            ]
          ]
          [.$\vdots$
          ]
          [.$\vdots$
          ]
        ]
        [.$\vdots$
        ]
        [.$\vdots$
        ]
      ]
    ]
}    

\vfill

$h = \log_2 n
\hfill
3^{\log_2 n} = n^{\log_2 3} \approx n^{1.6}\mbox{ leaves}
\hfill
\sum_{i=0}^{\log_b n} a^i f(n/b^i)
$

\end{frame}

\sect{Comparing leaves to internal nodes}
\bi
\ii Number of leaves: $n^{\log_b a}$
\ii Internal time: $\sum_{i=0}^{\log_b n} a^if(n/b^i)$
\ii Suppose $f(n) = n$, $a=b=4$, $n^{\log_b a} = n$
\ei
\begin{align*}
  \sum_{i=0}^{\log_4 n} a^if(n/b^i)
  &=
  \sum_{i=0}^{\log_4 n} 4^i(n/4^i)\\
  &=
  \sum_{i=0}^{\log_4 n} n\\
  &= \Theta(n\lg n)\\\\
  n^{\log_b a} + \Theta(n\lg n) &= \Theta(n\lg n)
\end{align*}

\end{frame}


\sect{Comparing leaves to internal nodes}
\bi
\ii Number of leaves: $n^{\log_b a}$
\ii Internal time: $\sum_{i=0}^{\log_b n} a^if(n/b^i)$
\ii Suppose $f(n) = n$, $a=4$, $b=2$, $n^{\log_b a} = n^2$
\ei
\begin{align*}
  \sum_{i=0}^{\log_2 n} a^if(n/b^i)
  &=
  \sum_{i=0}^{\log_2 n} 4^i(n/2^i)\\
  &=
  n \sum_{i=0}^{\log_2 n} 2^i\\
  &= \Theta(n^2)\\\\
  n^{\log_b a} + \Theta(n^2) &= \Theta(n^2)
\end{align*}

\end{frame}

\sect{Comparing leaves to internal nodes}
\bi
\ii Number of leaves: $n^{\log_b a}$
\ii Internal time: $\sum_{i=0}^{\log_b n} a^if(n/b^i)$
\ii Suppose $f(n) = n^2$, $a=b=4$, $n^{\log_b a} = n$
\ei
\begin{align*}
  \sum_{i=0}^{\log_4 n} a^if(n/b^i)
  &=
  \sum_{i=0}^{\log_4 n} 4^i(n/4^i)^{2}\\
  &=
  \sum_{i=0}^{\log_4 n} \left(\frac{4}{4^{2}}\right)^in^{2}\\
  &=
  n^2\sum_{i=0}^{\log_4 n} (1/4)^i\\
  &= \Theta(n^2)\\\\
  n^{\log_b a} + \Theta(n^2) &= \Theta(n^2)
\end{align*}

\end{frame}




\sect{Comparing leaves to internal nodes}
\bi
\ii Number of leaves: $n^{\log_b a}$
\ii Internal time: $\sum_{i=0}^{\log_b n} a^if(n/b^i)$
\ii Suppose $f(n) = n^2$, $a=4$, $b=2$, $n^{\log_b a} = n^2$
\ei
\begin{align*}
  \sum_{i=0}^{\log_b n} a^if(n/b^i)
  &=
  \sum_{i=0}^{\log_2 n} 4^i(n/2^i)^{2}\\
  &=
  \sum_{i=0}^{\log_2 n} \left(\frac{4}{2^{2}}\right)^in^{2}\\
  &=
  n^2\sum_{i=0}^{\log_2 n} (1)^i\\
  &= \Theta(n^2\lg n)\\\\
  n^{\log_b a} + \Theta(n^2\lg n) &= \Theta(n^2\lg n)
\end{align*}

\end{frame}


\sect{Comparing leaves to internal nodes}
\bi
\ii Number of leaves: $n^{\log_b a}$
\ii Internal time: $\sum_{i=0}^{\log_b n} a^if(n/b^i)$
\ii Suppose $f(n) = n^2$, $a=8$, $b=2$, $n^{\log_b a} = n^3$
\ei
\begin{align*}
  \sum_{i=0}^{\log_4 n} a^if(n/b^i)
  &=
  \sum_{i=0}^{\log_b n} 8^i(n/2^i)^{2}\\
  &=
  \sum_{i=0}^{\log_b n} \left(\frac{8}{2^{2}}\right)^in^{2}\\
  &=
  n^2\sum_{i=0}^{\log_b n} 2^i\\
  &= \Theta(n^2\lg n)\\\\
  n^{\log_b a} + \Theta(n^2\lg n) &= \Theta(n^2\lg n)
\end{align*}

\end{frame}



\sect{Comparing leaves to internal nodes}
\bi
\ii Number of leaves: $n^{\log_b a}$
\ii Internal time: $\sum_{i=0}^{\log_b n} a^if(n/b^i)$
\ii Suppose $f(n) = n^{\log_b a}$ 
\ei
\begin{align*}
  \sum_{i=0}^{\log_b n} a^if(n/b^i)
  &=
  \sum_{i=0}^{\log_b n} a^i(n/b^i)^{\log_b a}\\
  &=
  \sum_{i=0}^{\log_b n} \left(\frac{a}{b^{\log_b a}}\right)^in^{\log_b a}\\
  &=
  \sum_{i=0}^{\log_b n} n^{\log_b a}\\
  &=
  n^{\log_b a} \log_b n\\
  &= \Theta(f(n)\lg n)
\end{align*}

\end{frame}

\sect{Master Theorem}
Let $a\geq 1$ and $b > 1$ be constants, let $f(n)$ be a function, and
let $T(n)$ be defined on nonnegative integers by
\[
T(n) = aT\left(\frac{n}{b}\right) + f(n)
\]
Then $T(n)$ has the following asymptotic bounds:
\bigskip
\begin{center}
{\large
\begin{tabular}{r|l}
$f(n)$ & $T(n)$ \\\hline 
$\mbox{O}(n^{\log_b a - \epsilon})$& $ \Theta(n^{\log_b a })$\\
$\Theta(n^{\log_b a})$ & $\Theta(f(n)\lg n)$\\
$\Omega(n^{\log_b a + \epsilon})$ & $\Theta(f(n))$\\
\end{tabular}
}\end{center}
\bigskip

The last one only if $af(\frac{n}{b}) \leq cf(n)$ for some $c<1$
and large enough $n$.
\end{frame}

\sect{Master theorem example 1}

\begin{align*}
  T(n) &= aT\left(\frac{n}{b}\right) + f(n)\\
O(n^{\log_b a - \epsilon})&\Leftrightarrow \Theta(n^{\log_b a })\\
\Theta(n^{\log_b a}) &\Leftrightarrow \Theta(f(n)\lg n)\\
\Omega(n^{\log_b a + \epsilon}) &\Leftrightarrow \Theta(f(n))
&\mbox{when } af(n/b) \leq cf(n)
\end{align*}

\begin{align*}
  T(n) &= 2T\left(\frac{n}{2}\right) + n\\
  \log_b a &= 1\\
  f(n) &= \Theta(n^{\log_b a})\\
  T(n) &= \Theta(n\lg n)
\end{align*}

\end{frame}

\sect{Master theorem example 2}

\begin{align*}
  T(n) &= aT\left(\frac{n}{b}\right) + f(n)\\
O(n^{\log_b a - \epsilon})&\Leftrightarrow \Theta(n^{\log_b a })\\
\Theta(n^{\log_b a}) &\Leftrightarrow \Theta(f(n)\lg n)\\
\Omega(n^{\log_b a + \epsilon}) &\Leftrightarrow \Theta(f(n))
&\mbox{when } af(n/b) \leq cf(n)
\end{align*}

\begin{align*}
  T(n) &= 4T(n/2) + n^2\\
  \log_b a &= 2\\
  f(n) &= \Theta(n^{\log_b a})\\
  T(n) &= \Theta(n^2\lg n)
\end{align*}

\end{frame}


\sect{Master theorem example 3}

\begin{align*}
  T(n) &= aT\left(\frac{n}{b}\right) + f(n)\\
O(n^{\log_b a - \epsilon})&\Leftrightarrow \Theta(n^{\log_b a })\\
\Theta(n^{\log_b a}) &\Leftrightarrow \Theta(f(n)\lg n)\\
\Omega(n^{\log_b a + \epsilon}) &\Leftrightarrow \Theta(f(n))
&\mbox{when } af(n/b) \leq cf(n)
\end{align*}

\begin{align*}
  T(n) &= 4T(n/2) + \lg n\\
  \log_b a &= 2\\
  f(n) &= O(n^{\log_b a - \epsilon})\\
  T(n) &= \Theta(n^2)
\end{align*}

\end{frame}


\sect{Master theorem example 4}

\begin{align*}
  T(n) &= aT\left(\frac{n}{b}\right) + f(n)\\
O(n^{\log_b a - \epsilon})&\Leftrightarrow \Theta(n^{\log_b a })\\
\Theta(n^{\log_b a}) &\Leftrightarrow \Theta(f(n)\lg n)\\
\Omega(n^{\log_b a + \epsilon}) &\Leftrightarrow \Theta(f(n))
&\mbox{when } af(n/b) \leq cf(n)
\end{align*}

\begin{align*}
  T(n) &= 4T(n/2) + n^3\\
  \log_b a &= 2\\
  f(n) &= \Omega(n^{\log_b a + \epsilon})\\
  T(n) &= \Theta(n^3)
\end{align*}
because
\begin{align*}
  af(n/b) &= 4f(n/2)\\
  &= 4/2^3 f(n) \leq cf(n)\\
\end{align*}


\end{frame}



\sect{Master theorem does not apply}
\begin{align*}
  T(n) &= 2T(n/2) + n\lg n\\
  n^{\log_b a} &= n\\
  f(n) &= n\lg n\\
  f(n) &= \Omega(n^{\log_b a}) = \Omega(n)\\
  f(n) &\not= \Omega(n^{\log_b a+\epsilon}) = \Omega(n^{1+\epsilon})\\
n\lg n &\not= \Omega(n^{1.0000000000001})\\
\lg n &\not= \Omega(n^{0.0000000000001})\\
\end{align*}
\end{frame}

\sect{Master theorem does apply}
\begin{align*}
  T(n) &= 4T(n/3) + n\lg n\\
  n^{\log_b a} &= n^{\log_c 4} = n^{1.26...}\\
  f(n) &= n\lg n\\
  f(n) &= O(n^{\log_b a}) = O(n^{1.26...})\\
  f(n) &= O(n^{\log_b a-\epsilon}) = O(n^{1.2}) & \epsilon = 0.06...\\
  n\lg n &= O(n^{1.2})\\
  \lg n &= O(n^{0.2})\\
\end{align*}
\end{frame}
\end{document}
